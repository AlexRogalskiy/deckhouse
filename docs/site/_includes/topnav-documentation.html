<div class="header">
    <div class="page__container">
        <div class="header__content">
            <a href="/" class="header__logo">
                <img src="/images/d8-logo.png" alt="deckhouse" width="240"/>
            </a>
            <ul class="header__menu header__menu_active">
                <!-- toggle sidebar button -->
                <!-- entries without drop-downs appear here -->

{% assign topnav = site.data[page.topnav].topnav %}
{% assign topnav_dropdowns = site.data[page.topnav].topnav_dropdowns %}

                {% for entry in topnav %}
                  {% for item in entry.items %}
                    <li class="header__menu-item
                        {%- if item.folderitems %} header__menu-item_parent{% endif %}
                        {%- if item.url.size>1 and page.url == item.url %} header__menu-item_active{% endif %}
                        {%- if item.url.size<2 and page.url.size<2 %} header__menu-item_active{% endif %}">
<!--                    {%- if item.url.size>1 and page.url != item.url and page.url contains item.url %} header__menu-item_active{% endif %} -->
                      <a href="/{{ page.lang }}{{ item.url }}">{%- if item.title[page.lang] %}{{ item.title[page.lang] }}{% else %}{{ item.title }}{% endif -%}</a>
                      {%- if item.folderitems %}
                      <div class="header__submenu-container">
                          <ul class="header__submenu">
                            {%- for folderitem in item.folderitems %}
                              {%- if folderitem.title[page.lang] %}
                              {%- assign folderitem_title = folderitem.title[page.lang] %}
                              {%- else %}
                              {%- assign folderitem_title = folderitem.title %}
                              {%- endif %}
                              {% if folderitem.external_url %}
                              <li class="header__submenu-item">
                                <a href="{{folderitem.external_url}}" target="_blank" rel="noopener">{{folderitem_title}}</a></li>
                              {% elsif page.url contains folderitem.url %}
                              <li class="header__submenu-item"><a href="/{{ folderitem.url | remove_first: "/" }}">{{folderitem_title}}</a></li>
                              {% else %}
                              <li class="header__submenu-item"><a href="/{{ folderitem.url | remove_first: "/" }}">{{folderitem_title}}</a></li>
                              {% endif %}
                            {%- endfor %}
                          </ul>
                      </div>
                      {%- endif %}
                    </li>
                  {% endfor %}
                {% endfor %}
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                {% for entry in topnav_dropdowns %}
                {% for folder in entry.folders %}
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">{%- if folder.title[page.lang] %}{{ folder.title[page.lang] }}{% else %}{{ folder.title }}{% endif -%}<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        {%- for folderitem in folder.folderitems %}
                        {%- if folderitem.title[page.lang] %}
                        {%- assign folderitem_title = folderitem.title[page.lang] %}
                        {%- else %}
                        {%- assign folderitem_title = folderitem.title %}
                        {%- endif %}
                        {%- if folderitem.external_url %}
                        <li><a href="{{folderitem.external_url}}" target="_blank" rel="noopener">{{folderitem_title}}</a></li>
                        {%- elsif page.url contains folderitem.url %}
                        <li class="dropdownActive"><a href="/{{folderitem.url | remove_first: "/" }}">{{folderitem_title}}</a></li>
                        {% else %}
                        <li><a href="/{{folderitem.url | remove_first: "/" }}">{{folderitem_title}}</a></li>
                        {%- endif %}
                        {%- endfor %}
                    </ul>
                </li>
                {% endfor %}
                {% endfor %}
                {% if site.feedback_disable == null or site.feedback_disable == false %}
			{% include feedback.html %}
		{%- endif %}
		{%- unless site.local_mode %}
                <li class="header__menu-item header__menu-item_parent submenu-parent">
                    <a href="#">
                        {%- if page.lang == "ru" %}
                            Russian
                        {%- else %}
                            English
                        {%- endif %}
                    </a>{% raw %}
                    <div class="submenu-container">
                      <ul class="submenu">
                        <li data-proofer-ignore class="submenu-item">
                            <a data-proofer-ignore href="/en{{ .MenuDocumentationLink }}{{ .CurrentPageURLRelative }}" class="submenu-item-link">
                                English
                            </a>
                        </li>
                        <li data-proofer-ignore class="submenu-item">
                            <a data-proofer-ignore href="/ru{{ .MenuDocumentationLink }}{{ .CurrentPageURLRelative }}" class="submenu-item-link">
                                Russian
                            </a>
                        </li>
                      </ul>
                    </div>{% endraw %}
                </li>

                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div class="header-search">
                        <form action="/search.html" method="get">
                        <input type="text" class="header-search__input" id="search-box" name="query" placeholder="{{site.data.strings.search_placeholder_text}}">
                        </form>
                    </div>
                    <!--end search-->
                </li>
		{%- endunless %}
            </ul>
        </div>
    </div>
        <!-- /.container -->
</div>
