{{- range $instance := .Values.prometheusPushgateway.instances }}
---
apiVersion: v1
kind: Service
metadata:
  name: {{ $instance }}
  namespace: kube-{{ $.Chart.Name }}
  labels:
    heritage: antiopa
    module: {{ $.Chart.Name }}
    app: {{ $instance }}
    prometheus-target: {{ $.Chart.Name }}
spec:
  type: ClusterIP
  clusterIP: None
  ports:
  - name: http-metrics
    port: 9091
  selector:
    app: {{ $instance }}
{{- end }}
