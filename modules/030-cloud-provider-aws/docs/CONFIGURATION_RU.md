---
title: "Сloud provider — AWS: настройки"
---

## Параметры

Модуль настраивается автоматически исходя из выбранной схемы размещения (custom resource `AWSClusterConfiguration`). В большинстве случаев нет необходимости ручной конфигурации модуля.

Количество и параметры процесса заказа машин в облаке настраиваются в custom resource [`NodeGroup`](../../modules/040-node-manager/cr.html#nodegroup) модуля node-manager, в котором также указывается название используемого для этой группы узлов instance-класса (параметр `cloudInstances.classReference` NodeGroup).  Instance-класс для cloud-провайдера AWS — это custom resource [`AWSInstanceClass`](cr.html#awsinstanceclass), в котором указываются конкретные параметры самих машин.

## Storage

Модуль автоматически создаёт StorageClasses, которые есть в AWS: `gp3`, `gp2`, `sc1` и `st1`. Позволяет сконфигурировать диски с необходимым IOPS. А также отфильтровать ненужные StorageClass, указанием их в параметре `exclude`.

* `provision` — создать дополнительные StorageClass или переопределить параметры создаваемых по-умолчанию.
  * Формат — массив объектов.
    * `name` — имя будущего класса.
    * `type` — тип диска, `gp3`, `gp2`, `sc1`, `st1` или `io1`, `io2`.
    * `iopsPerGB` — I/O операций в секунду на каждый Гб (у дисков `gp2` этот параметр `3`) для дисков типа `io1` или `io2`.
      * **Внимание!** Если это значение, умноженное на размер запрошенного диска, будет меньше 100 или больше 64000, создание такого диска завершится ошибкой.
      * Подробное описание типов дисков и их IOPS, вы найдёте в [официальной документации](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volume-types.html).
    * `iops` — I/O операций в секунду для дисков типа `gp3`.
      * Формат — число.
      * Опциональный параметр.
      * Диапазон возможных значений от 3000 до 16000.
      * Если параметр не задан, будет использоваться значение 3000, согласно [документации](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volume-types.html).
    * `throughput` — пропускная способность в MiB/s для дисков типа `gp3`.
      * Формат — число.
      * Опциональный параметр.
      * Диапазон возможных значений от 125 до 1000.
      * Если параметр не задан, будет использоваться значение 125, согласно [документации](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volume-types.html).
    > ℹ️ Изменение `iops` и `throughput` в конфигурации не приводит к изменению этих параметров для уже созданных дисков. Правьте их вручную через консоль управления AWS.
  * Опциональный параметр.
* `exclude` — полные имена (или regex выражения имён) StorageClass, которые не будут созданы в кластере.
  * Формат — массив строк.
  * Опциональный параметр.
* `default` — имя StorageClass, который будет использоваться в кластере по умолчанию.
  * Формат — строка.
  * Опциональный параметр.
  * Если параметр не задан, фактическим StorageClass по умолчанию будет либо: 
    * Присутствующий в кластере произвольный StorageClass с default аннотацией.
    * Лексикографически первый StorageClass из создаваемых модулем.

```yaml
cloudProviderAws: |
  storageClass:
    provision:
    - iopsPerGB: 5
      name: iops-foo
      type: io1
    exclude: 
    - sc.*
    - st1
    default: gp2
```
