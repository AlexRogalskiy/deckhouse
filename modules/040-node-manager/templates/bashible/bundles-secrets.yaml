{{- range $bundle := list "ubuntu-lts" "ubuntu-18.04" "centos-7" }}
  {{- range $ng := $.Values.nodeManager.internal.nodeGroups }}
---
apiVersion: v1
kind: Secret
metadata:
  name: bashible-bundle-{{ $bundle }}-{{ $ng.name }}
  namespace: d8-cloud-instance-manager
{{ include "helm_lib_module_labels" (list $) | indent 2 }}
type: Opaque
data:
{{- if eq $bundle "ubuntu-18.04" }}
{{- include "bundles_rendered_steps_node_group" (list $ "ubuntu-lts" $ng) | indent 2 -}}
{{- else }}
{{- include "bundles_rendered_steps_node_group" (list $ $bundle $ng) | indent 2 -}}
{{- end }}
  {{- end }}

  {{- range $kubernetes_version := list "1.14" "1.15" "1.16" "1.17" "1.18" }}
---
apiVersion: v1
kind: Secret
metadata:
  name: bashible-bundle-{{ $bundle }}-{{ $kubernetes_version }}
  namespace: d8-cloud-instance-manager
{{ include "helm_lib_module_labels" (list $) | indent 2 }}
type: Opaque
data:
{{- if eq $bundle "ubuntu-18.04" }}
{{- include "bundles_rendered_steps_all" (list $ "ubuntu-lts" $kubernetes_version) | indent 2 -}}
{{- else }}
{{- include "bundles_rendered_steps_all" (list $ $bundle $kubernetes_version) | indent 2 -}}
{{- end }}
  {{- end }}
{{- end }}
