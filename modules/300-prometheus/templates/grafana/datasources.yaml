apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-datasources
  namespace: kube-prometheus
  labels:
    heritage: antiopa
    module: {{ $.Chart.Name }}
    app: grafana
data:
  prometheus.yaml: |+
    apiVersion: 1
    datasources:
     - name: main
       type: prometheus
       access: direct
       orgId: 1
       url: /prometheus
       version: 1
       isDefault: true
       jsonData:
         timeInterval: 30s
{{- if .Values.prometheus.longtermRetentionDays }}
     - name: longterm
       type: prometheus
       access: direct
       orgId: 1
       url: /prometheus/longterm
       version: 1
       jsonData:
         timeInterval: 300s
{{- end }}
