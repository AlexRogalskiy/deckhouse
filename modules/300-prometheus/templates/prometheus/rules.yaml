{{- range (tuple "coreos" "kubernetes" "applications") }}
---
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: {{ . }}
  namespace: kube-prometheus
  labels:
    heritage: antiopa
    module: {{ $.Chart.Name }}
    app: prometheus
    prometheus: main
    component: rules
spec:
  groups:
  {{- $root := $ }}
  {{- range $path, $bytes := $.Files.Glob (print "prometheus-rules/" . "/*.yaml") }}
{{ $root.Files.Get $path | indent 4 }}
  {{- end }}
{{- end }}
