---
title: "Модуль control-plane-configurator"
---

Данный модуль перманентно следит за манифестами control-plane (пока только kube-apiserver) и следит, чтобы настройки соответствовали [параметрам модуля](#параметры):

* Управление плагином авторизации [Webhook](https://kubernetes.io/docs/reference/access-authn-authz/webhook/).
* Внешняя аутентификация пользователей через OIDC.

Пока модуль включен — это единственный легитимный способ внести нужные настройки перечисленных подсистем в манифест. Остальные параметры можно настраивать вручную.

**Важно!** При модификации манифест-файлов, kubelet перезагрузит соответствующие control-plane-компоненты. Соответственно, будут кратковременные выпадания этих компонентов из работы. При этом бекап оригинального манифеста сохранится в каталоге /etc/kubernetes (пример бекапного файла — /etc/kubernetes/kube-apiserver-manifest-backup-2019-10-11T12:19:02.453582).

Конфигурация
------------

### Выключение модуля

Модуль по-умолчанию **включен**. Для выключения добавьте в CM `deckhouse`:

```yaml
data:
  controlPlaneConfiguratorEnabled: "false"
```

### Параметры

* `authzWebhook` — настройки, связанные с [механизмом авторизации Webhook](https://kubernetes.io/docs/reference/access-authn-authz/webhook/).
  * Параметры:
    * `url` — URL, куда apiserver будет отправлять authz-запросы.
    * `ca` — Certificate Authority для сертификата, который используется в `webhook.url`.
  * По-умолчанию — будут использованы данные, экспортированные модулем [user-authz]({{ site.baseurl }}/modules/140-user-authz) (через специальный ConfigMap).
* `oidc` — настройки внешней аутентификации через механизм OpenID.
  * Параметры:
    * `issuerURL` — URL OIDC провайдера.
    * `ca` — Certificate Authority для сертификата, который используется в `oidc.issuerURL`.
      * Необязательный параметр. Если в `oidc.issuerURL` используется сертификат от публичного провайдера, то можно CA не указывать.
  * По-умолчанию — будут использованы данные, экспортированные модулем [user-authn]({{ site.baseurl }}/modules/150-user-authn) (через специальный ConfigMap).
