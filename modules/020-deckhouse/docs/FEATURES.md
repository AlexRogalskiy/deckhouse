---
title: "Управляющий модуль Deckhouse"
---

Этот [модуль]({{site.baseurl}}/modules/020-deckhouse) предназначен для настройки параметров самого Deckhouse, позволяет:
- [выбрать](#наборы-модулей) один из наборов модулей для установки в кластер
- [указать](#настройка-логирования) уровень подробности логирования
- [управлять](#релизный-канал) релизным каналом

## Наборы модулей

Deckhouse может развертываться в кластере в двух возможных конфигурациях:
- `Minimal`. В этом случае будут выключены все модули, кроме текущего и вам нужно включить каждый необходимый модуль самостоятельно. При выборе варианта поставки minimal гарантируется, что с последующими обновлениями Deckhouse не будет включено никаких дополнительных модулей, кроме тех, что вы включили вручную.
- `Default`. Как и следует из названия, этот режим используется по умолчанию. Если вы оставите режим `default`, то будет активирован стандартный набор модулей. Важно понимать, что с обновлениями могут быть `включены` (но не выключены) `дополнительные модули`, если они применимы и корректно работают в вашей инсталляции Kubernetes и не требуют настройки.
- `Managed`. Поставка для managed-кластеров от облачных провайдеров, например [Google Kubernetes Engine](https://cloud.google.com/kubernetes-engine/docs/concepts/kubernetes-engine-overview?hl=ru) (GKE) и [Amazon EKS](https://aws.amazon.com/ru/eks/). В этой поставке также с обновлениями могут быть `включены` (но не выключены) `дополнительные модули`, если они применимы и корректно работают в вашей инсталляции Kubernetes и не требуют настройки.

## Настройка логирования

Модуль [deckhouse]({{page.module}}) также позволяет управлять уровнем логирования самого Deckhouse. Возможные значения:
- `Debug` — самый подробный уровень
- `Info` — уровень по умолчанию
- `Error` — наиболее лаконичный уровень, отображающий только ошибки.

## Релизный канал

На текущий момент доступны следующие релизные каналы (в порядке возрастания стабильности:
- **Alpha** – может содержать новые возможности и быть нестабильным. Релизы выполняются с высокой периодичностью.
- **Beta** – предназначен для более детального тестирования новых возможностей. 
- **Early-Access** – безопасно использовать в некритичных окружениях и при локальной разработке.
- **Stable** – считается безопасным и рекомендуемым для всех окружений. 
- **Rock-Solid** – рекомендуется использовать в критичных окружениях с высоким SLA.

![](/images/release-channels.png)


При изменении релизного канала в настройках модуля *deckhouse*, релизный канал будет автоматически плавно изменяться на указанный. Раз в 10 минут проверяется, соответствует ли тег Docker-образа из выбранного канала обновлений текущему тегу Docker-образа Deckhouse. Если не соответствует, будет запущена одна из процедур плавного изменения релизного канала.

## Переключение на более стабильный канал
При смене канала обновлений на более стабильный, например с *Alpha* на *Early-Access*, будет произведен плавный переход. 
Смена канала на более стабильный происходит только тогда, когда используемые в текущем канале Docker-образы будут приняты в более стабильный канал. Реализуется это следующим образом:
- Первым этапом проверяется равенство [digest](https://success.docker.com/article/images-tagging-vs-digests) для тегов Docker-образов, соответствующих текущему каналу обновлений (в нашем примере — *Alpha*) и ближайшему к нему более стабильному (в нашем примере — *Beta*). Если digest'ы равны, будет переключен релизный канал на *Beta*.
- Далее будет проверен следующий по очереди тег (в нашем примере соответствующий каналу обновлений *Early-Access*) и, опять же, переключение произойдет только тогда, когда digest'ы станут равны.

В итоге Deckhouse будет переключен на более стабильный канал без downgrade по возможностям.

## Переключение на менее стабильный канал
Обратное переключение устроено проще, например нам нужно переключиться с канала *Early-Access* на *Alpha*. В этом случае будут сверены digest'ы, соответствующие образам Docker для текущего канала обновлений и следующего менее стабильного, в нашем случае - *Beta*. 

Если digest не равны, Deckhouse будет переключен на следующий канал обновлений, в нашем случае на Beta. Это необходимо, чтобы не пропустить важные миграции, которые проводятся при обновлении Deckhouse. Если digest равны, будет проверен следующий по убыванию стабильности канал обновлений (в нашем примере - *Alpha*).
Когда проверка дойдет до желаемого канала обновлений (в примере — *Alpha*), переключение Deckhouse произойдет независимо от равенства digest.
