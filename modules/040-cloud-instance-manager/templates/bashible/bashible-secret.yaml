{{- $context := . }}
{{- range $ig := .Values.cloudInstanceManager.internal.instanceGroups }}
  {{- $bundle := $ig.instanceClass.bashible.bundle | trimSuffix "-1.0" }}
---
apiVersion: v1
kind: Secret
metadata:
  name: bashible-{{ $ig.name }}-{{ $bundle }}
  namespace: d8-{{ $.Chart.Name }}
{{ include "helm_lib_module_labels" (list $) | indent 2 }}
type: Opaque
data:
  bashible.sh: {{ include "instance_group_machine_class_bashible_bashible_script" (list $context $ig) | b64enc }}
{{- end }}
