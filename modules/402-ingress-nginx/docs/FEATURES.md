---
title: "Балансировщик Ingress Nginx"
---

Данный модуль автоматически устанавливает и управляет [NGINX Ingress Controller](https://github.com/kubernetes/ingress-nginx), который ставится в отказоустойчивом режиме (если нод больше одной) и учитывает все особенности реализации инфраструктуры облаков и bare-metal, а также кластеров Kubernetes различных типов.

Модуль поддерживает запуск и раздельное конфигурирование одновременно нескольких NGINX Ingress контроллеров — один **основной** и сколько угодно **дополнительных**. Например, это позволяет отделять внешние и intranet Ingress-ресурсы приложений.

## Варианты терминирования трафика:
Трафик к nginx-ingress может быть отправлен несколькими способами:
- напрямую без внешнего балансировщика
- через внешний LoadBalancer, а в том числе поддерживаются:
  - Qrator
  - Cloudflare
  - AWS LB
  - GCE LB
  - ACS LB
  - Yandex LB
  - OpenStack LB

## Терминация https
Модуль позволяет управлять для каждого из NGINX Ingress контроллера политиками безопасности HTTPS, в частности:
- параметрами hsts;
- набором доступных версий SSL/TLS и протоколов шифрования.

Также модуль интегрирован с модулем [cert-manager](/modules/101-cert-manager/), при взаимодействии с которым возможен автоматический заказ SSL-сертификатов и их дальнейшее использование NGINX Ingress контроллерaми.

## Мониторинг и статистика
В нашей реализации Ingress Nginx добавлена система сбора статистики в Prometheus с множеством метрик по:
- длительности времени всего ответа и апстрима отдельно;
- кодам ответа;
- количеству повторов запросов (retry);
- размерам запроса и ответа;
- методам запросов;
- типам `content-type`;
- географии распределения запросов и т.д.

Данные доступны в нескольких разрезах по:
- `namespace`,
- `vhost`,
- `ingress`-ресурсу,
- `location` (в nginx).

Все графики собраны в виде удобных досок в Grafana, при этом есть возможность drill-down по графикам: при просмотре, например, статистики в разрезе namespace – есть возможность нажав на ссылку на dashboard в Grafana углубиться в статистику по `vhosts` в этом `namespace` и т.д.
