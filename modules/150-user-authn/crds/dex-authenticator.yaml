apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: dex-authenticators.deckhouse.io
  labels:
    heritage: deckhouse
    module: user-authn
spec:
  group: deckhouse.io
  scope: Namespaced
  names:
    plural: dex-authenticators
    singular: dex-authenticator
    kind: DexAuthenticator
    shortNames:
    - dex-auth
  version: v1alpha1
  additionalPrinterColumns:
  - JSONPath: .spec.applicationDomain
    name: Domain
    type: string
  validation:
    openAPIV3Schema:
      type: object
      required:
      - spec
      properties:
        spec:
          type: object
          required:
          - applicationDomain
          - applicationIngressCertificateSecretName
          properties:
            applicationDomain:
              type: string
              description: 'Public domain that points to your application. Must be specified without HTTP scheme.'
              example: 'my-app.domain.com'
            sendAuthorizationHeader:
              type: boolean
              description: 'Request to application will be sent with "Autorization: Bearer" header when the option is switched to true.'
            applicationIngressCertificateSecretName:
              type: string
              description: 'Name of TLS-certificate secret specified in your application Ingress object to add to dex authenticator Ingress object for HTTPS access. Secret must be located in the same namespace with DexAuthenticator object.'
              example: 'ingress-tls'
            allowedGroups:
              type: array
              description: 'Groups that the user should be in to authenticate successfully. Additionally, this parameter limits the list of groups that will be put into OIDC token (there will be an intersection of the specified groups and the actual groups of the user).'
              items:
                type: string
