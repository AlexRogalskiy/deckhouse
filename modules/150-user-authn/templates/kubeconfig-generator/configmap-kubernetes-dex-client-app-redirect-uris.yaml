{{- if or (.Values.userAuthn.kubeconfigGenerator) (.Values.userAuthn.publishAPI) }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Chart.Name }}-kubernetes-dex-client-app-redirect-uris
  namespace: d8-user-authn
{{ include "helm_lib_module_labels" (list . (dict "app" "kubernetes-configurator")) | indent 2 }}
data:
{{- range $index, $cluster := .Values.userAuthn.kubeconfigGenerator }}
  {{ $cluster.id }}-{{ $index }}: https://{{ include "helm_lib_module_public_domain" (list $ "kubeconfig") }}/callback/{{ $index }}
{{- end }}
{{- if .Values.userAuthn.publishAPI }}
  {{ printf "%s-%s" .Values.global.project .Values.global.clusterName }}: https://{{ include "helm_lib_module_public_domain" (list . "kubeconfig") }}/callback/
{{- end }}
{{- end }}
