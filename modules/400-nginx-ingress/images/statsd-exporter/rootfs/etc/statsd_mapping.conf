# ingress_nginx_overall_request_seconds_{sum,count,bucket}
#
#request_time|http|pult-production|api.someproject.somedomain:60|h
#ns|request_time|pult-production|pult-servers-api:60|h
#ns_s|request_time|pult-production|pult-servers-api|pult-servers-api-web|80:60|h
#s|request_time|api.someproject.somedomain|/:60|h

# ingress_nginx_overall_sent_bytes_total
#
#bytes_sent|http|pult-production|api.someproject.somedomain:37098000|h
#ns|bytes_sent|pult-production|pult-servers-api:37098000|h
#ns_s|bytes_sent|pult-production|pult-servers-api|pult-servers-api-web|80:37098000|h
#s|bytes_sent|api.someproject.somedomain|/:37098000|h

# ingress_nginx_service_backend_response_seconds_{...}
#
#ns_s_b|upstream_response_time|pult-production|pult-servers-api|pult-servers-api-web|80|10.244.2.250:52|h
#s_b|upstream_response_time|api.someproject.somedomain|/|10.244.2.250:52|h

# ingress_nginx_service_backend_responses_total
#
#ns_s_b|response_status|pult-production|pult-servers-api|pult-servers-api-web|80|10.244.2.250|200:1|c
#s_b|response_status|api.someproject.somedomain|/|10.244.2.250|200:1|c

# ingress_nginx_overall_upstream_response_seconds_{...}
#
#upstream_response_time|http|pult-production|api.someproject.somedomain:52|h
#ns|upstream_response_time|pult-production|pult-servers-api:52|h
#ns_s|upstream_response_time|pult-production|pult-servers-api|pult-servers-api-web|80:52|h
#s|upstream_response_time|api.someproject.somedomain|/:52|h

# ingress_nginx_overall_upstream_retries_total
#
#upstream_retries|http|pult-production|api.someproject.somedomain:1|c
#ns|upstream_retries|pult-production|pult-servers-api:1|c
#ns_s|upstream_retries|pult-production|pult-servers-api|pult-servers-api-web|80:1|c
#s|upstream_retries|api.someproject.somedomain|/:1|c

# ingress_nginx_overall_upstream_redirects_total
#
#upstream_redirects|http|pult-production|api.someproject.somedomain:0|c
#ns|upstream_redirects|pult-production|pult-servers-api:0|c
#ns_s|upstream_redirects|pult-production|pult-servers-api|pult-servers-api-web|80:0|c
#s|upstream_redirects|api.someproject.somedomain|/:0|c
mappings:
- match: ^response_status#([^#]+)#([^#]+)#([^#]+)#([^#]+)$
  match_type: regex
  name: "ingress_nginx_overall_responses_total"
  labels:
    scheme: "$1"
    namespace: "$2"
    server_name: "$3"
    status: "$4"
#- match: ^ns#response_status#([^#]+)#([^#]+)#([^#]+)$
#  match_type: regex
#  name: "ingress_nginx_namespace_responses_total"
#  labels:
#    namespace: "$1"
#    ingress_name: "$2"
#    status: "$3"
#- match: ^ns_s#response_status#([^#]+)#([^#]+)#([^#]+)#([^#]+)#([^#]+)$
#  match_type: regex
#  name: "ingress_nginx_service_responses_total"
#  labels:
#    namespace: "$1"
#    ingress_name: "$2"
#    service_name: "$3"
#    service_port: "$4"
#    status: "$5"
#- match: ^s#response_status|#([^#]+)#([^#]+)#([^#]+)$
#  match_type: regex
#  name: "ingress_nginx_server_responses_total"
#  labels:
#    server_name: "$1"
#    location_path: "$2"
#    status: "$3"
- match: .
  match_type: regex
  action: drop
  name: "dropped"
