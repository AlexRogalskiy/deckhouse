kind: OpenStackClusterConfiguration
apiVersions:
- apiVersion: deckhouse.io/v1alpha1
  openAPISpec:
    type: object
    additionalProperties: false
    required: [apiVersion, kind, layout, provider]
    properties:
      apiVersion:
        type: string
        enum: [deckhouse.io/v1alpha1]
      kind:
        type: string
        enum: [OpenStackClusterConfiguration]
      layout:
        type: string
      standard:
        type: object
        additionalProperties: false
        required: [internalNetworkCIDR, internalNetworkDNSServers, externalNetworkName]
        properties:
          internalNetworkCIDR:
            type: string
          internalNetworkDNSServers:
            type: array
            items:
              type: string
          internalNetworkSecurity:
            type: boolean
            default: true
          externalNetworkName:
            type: string
      standardWithNoRouter:
        type: object
        additionalProperties: false
        required: [internalNetworkCIDR, externalNetworkName]
        properties:
          internalNetworkCIDR:
            type: string
          internalNetworkSecurity:
            type: boolean
            default: true
          externalNetworkName:
            type: string
      masterAsTheGateway:
        type: object
        additionalProperties: false
        required: [internalNetworkCIDR, internalNetworkDNSServers, externalNetworkName]
        properties:
          internalNetworkCIDR:
            type: string
          internalNetworkDNSServers:
            type: array
            items:
              type: string
          externalNetworkName:
            type: string
      simple:
        type: object
        additionalProperties: false
        required: [externalSubnetName]
        properties:
          externalSubnetName:
            type: string
          podNetworkMode:
            type: string
            enum: [VXLAN, DirectRouting, DirectRoutingWithPortSecurityEnabled]
            default: VXLAN
      simpleWithInternalNetwork:
        type: object
        additionalProperties: false
        required: [internalSubnetName]
        properties:
          internalSubnetName:
            type: string
          podNetworkMode:
            type: string
            enum: [VXLAN, DirectRouting, DirectRoutingWithPortSecurityEnabled]
            default: DirectRoutingWithPortSecurityEnabled
      provider:
        type: object
        additionalProperties: false
        properties:
          authURL:
            type: string
          caCert:
            type: string
          domainName:
            type: string
          tenantName:
            type: string
          tenantID:
            type: string
          username:
            type: string
          password:
            type: string
          region:
            type: string
        oneOf:
        - required: [authURL, domainName, tenantName, username, password, region]
        - required: [authURL, domainName, tenantID, username, password, region]
    oneOf:
    - required: [layout, standard]
      properties:
        layout:
          enum: [Standard]
          type: string
    - required: [layout, standardWithNoRouter]
      properties:
        layout:
          enum: [StandardWithNoRouter]
          type: string
    - required: [layout, masterAsTheGateway]
      properties:
        layout:
          enum: [MasterAsTheGateway]
          type: string
    - required: [layout, simple]
      properties:
        layout:
          enum: [Simple]
          type: string
    - required: [layout, simpleWithInternalNetwork]
      properties:
        layout:
          enum: [SimpleWithInternalNetwork]
          type: string
